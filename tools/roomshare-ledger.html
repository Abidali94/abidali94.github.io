<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üè† RoomShare Ledger Pro ‚Äî Daily Expense Splitter</title>
<style>
  :root {
    --orange: #ff7a00;
    --orange-dark: #cc6300;
    --bg-light: #f8f9fa;
    --bg-dark: #121212;
    --card-light: #ffffff;
    --card-dark: #1e1e1e;
    --text-dark: #222;
    --text-light: #e8e8e8;
    --border-light: #ddd;
    --border-dark: #333;
  }

  body {
    font-family: "Poppins", Arial, sans-serif;
    background: var(--bg-light);
    margin: 0;
    padding: 20px;
    color: var(--text-dark);
    transition: 0.3s;
  }

  body.dark {
    background: var(--bg-dark);
    color: var(--text-light);
  }

  h2 {
    text-align: center;
    color: var(--orange);
  }

  .section {
    background: var(--card-light);
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    transition: 0.3s;
  }

  body.dark .section {
    background: var(--card-dark);
    box-shadow: 0 2px 8px rgba(255,255,255,0.05);
  }

  input, button, select {
    padding: 8px 12px;
    border: 1px solid var(--border-light);
    border-radius: 8px;
    font-size: 14px;
    margin: 5px;
    background: inherit;
    color: inherit;
  }

  body.dark input, body.dark select {
    border: 1px solid var(--border-dark);
    background: #2a2a2a;
    color: var(--text-light);
  }

  button {
    background: var(--orange);
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: 0.25s;
  }
  button:hover {
    background: var(--orange-dark);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }

  th, td {
    border: 1px solid var(--border-light);
    padding: 8px;
    text-align: center;
  }

  body.dark th, body.dark td {
    border: 1px solid var(--border-dark);
  }

  th {
    background: var(--orange);
    color: #fff;
  }

  .summary {
    background: #fff3e6;
    padding: 15px;
    border-radius: 10px;
    font-weight: 600;
    text-align: center;
    margin-top: 15px;
  }

  body.dark .summary {
    background: #2b2b2b;
    color: var(--text-light);
  }

  .footer-buttons {
    text-align: center;
    margin-top: 25px;
  }

  .footer-buttons a {
    text-decoration: none;
    color: white;
    background: #444;
    padding: 10px 18px;
    border-radius: 8px;
    margin: 6px;
    font-weight: 600;
    display: inline-block;
    transition: 0.3s;
  }

  .footer-buttons a:hover {
    background: #666;
  }

  body.dark .footer-buttons a {
    background: #222;
  }

  .clear-btn {
    background: #d9534f;
  }
  .clear-btn:hover {
    background: #b52b27;
  }

  /* üåó Theme Toggle Button */
  .theme-toggle {
    position: fixed;
    top: 14px;
    right: 14px;
    background: var(--orange);
    color: white;
    border: none;
    border-radius: 6px;
    padding: 8px 12px;
    font-size: 14px;
    cursor: pointer;
    transition: 0.3s;
  }
  .theme-toggle:hover { background: var(--orange-dark); }
</style>
</head>
<body>

<button class="theme-toggle" onclick="toggleTheme()">üåô</button>

<h2>üè† RoomShare Ledger Pro</h2>

<div class="section">
  <h3>üë• Add Roommates</h3>
  <input type="text" id="personName" placeholder="Enter name">
  <button onclick="addPerson()">Add</button>
  <div id="personsList"></div>
</div>

<div class="section">
  <h3>üßæ Add Expense</h3>
  <input type="date" id="date">
  <select id="payer"></select>
  <input type="text" id="item" placeholder="Item (e.g., Groceries)">
  <input type="number" id="amount" placeholder="Amount ‚Çπ">
  <button onclick="addExpense()">Add Expense</button>
</div>

<div class="section">
  <h3>üìÖ Expense Ledger</h3>
  <table id="ledger">
    <thead>
      <tr>
        <th>Date</th>
        <th>Person</th>
        <th>Item</th>
        <th>Amount (‚Çπ)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div class="summary" id="summary">No expenses yet.</div>

<div class="footer-buttons">
  <a href="../index.html">‚Üê Back to Home</a>
  <a href="#" class="clear-btn" onclick="clearAll()">üßπ Clear All Data</a>
</div>

<script>
let persons = JSON.parse(localStorage.getItem('roomshare-persons') || '[]');
let expenses = JSON.parse(localStorage.getItem('roomshare-expenses') || '[]');

// üåó Load Theme (Sync with Index)
(function(){
  const t = localStorage.getItem('ks-theme');
  if(t === 'dark'){
    document.body.classList.add('dark');
    document.querySelector('.theme-toggle').textContent = '‚òÄÔ∏è';
  }
})();

function toggleTheme(){
  const d = document.body.classList.toggle('dark');
  localStorage.setItem('ks-theme', d ? 'dark' : 'light');
  document.querySelector('.theme-toggle').textContent = d ? '‚òÄÔ∏è' : 'üåô';
}

function addPerson() {
  const name = document.getElementById('personName').value.trim();
  if (!name) return alert("‚ö†Ô∏è Enter a valid name");
  if (persons.includes(name)) return alert("‚ö†Ô∏è Person already added!");
  persons.push(name);
  localStorage.setItem('roomshare-persons', JSON.stringify(persons));
  document.getElementById('personName').value = '';
  renderPersons();
}

function removePerson(name) {
  if (!confirm(`Remove ${name}?`)) return;
  persons = persons.filter(p => p !== name);
  localStorage.setItem('roomshare-persons', JSON.stringify(persons));
  renderPersons();
  render();
}

function renderPersons() {
  const list = document.getElementById('personsList');
  const payerSelect = document.getElementById('payer');
  list.innerHTML = '';
  payerSelect.innerHTML = '<option value="">Select Payer</option>';
  persons.forEach(p => {
    list.innerHTML += `<span style="margin-right:10px;">${p} <button onclick="removePerson('${p}')">‚ùå</button></span>`;
    payerSelect.innerHTML += `<option value="${p}">${p}</option>`;
  });
}

function addExpense() {
  const date = document.getElementById('date').value;
  const payer = document.getElementById('payer').value;
  const item = document.getElementById('item').value.trim();
  const amount = parseFloat(document.getElementById('amount').value);

  if (!date || !payer || !item || !amount) return alert("‚ö†Ô∏è Fill all fields!");

  expenses.push({ date, payer, item, amount });
  localStorage.setItem('roomshare-expenses', JSON.stringify(expenses));
  render();
}

function render() {
  const tbody = document.querySelector('#ledger tbody');
  tbody.innerHTML = '';
  let totals = {}, grandTotal = 0;

  expenses.forEach(e => {
    const row = `<tr>
      <td>${e.date}</td>
      <td>${e.payer}</td>
      <td>${e.item}</td>
      <td>${e.amount.toFixed(2)}</td>
    </tr>`;
    tbody.insertAdjacentHTML('beforeend', row);
    totals[e.payer] = (totals[e.payer] || 0) + e.amount;
    grandTotal += e.amount;
  });

  if (persons.length < 2) {
    document.getElementById('summary').innerHTML = "Add at least 2 persons to calculate split.";
    return;
  }

  const perPerson = grandTotal / persons.length;
  let summary = `üí∞ Total Spent: ‚Çπ${grandTotal.toFixed(2)}<br>`;
  summary += `Each Person Share: ‚Çπ${perPerson.toFixed(2)}<br><br>`;

  persons.forEach(p => {
    const paid = totals[p] || 0;
    const balance = paid - perPerson;
    summary += `${p}: ${balance >= 0 ? 'Gets' : 'Owes'} ‚Çπ${Math.abs(balance).toFixed(2)}<br>`;
  });

  document.getElementById('summary').innerHTML = summary;
}

function clearAll() {
  if (confirm("‚ö†Ô∏è Are you sure you want to clear all data?")) {
    localStorage.removeItem('roomshare-persons');
    localStorage.removeItem('roomshare-expenses');
    persons = [];
    expenses = [];
    renderPersons();
    render();
    alert("üßπ All data cleared!");
  }
}

renderPersons();
render();
</script>

</body>
</html>
